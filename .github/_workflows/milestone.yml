name: Milestone
on:
  create:
#  workflow_run:
#    workflows: ["Run Tests"]
#    branches: ['releases/*']
#    types:
#      - completed

jobs:
  build:
    runs-on: ubuntu-20.04
    steps:
      - run: git config --global --add safe.directory "$GITHUB_WORKSPACE"
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - id: version
        uses: ./.github/actions/version
#    runs-on: ubuntu-20.04
#    needs: [ aa]
#    steps:
      - name: Build RC docker
        run: |
          echo "======== ${{ steps.version.outputs.stage }} ==============="
          echo "======== ${{ steps.version.outputs.version }} ==============="
          echo "======== ${{ needs.parent.outputs.hash }} ==============="
          echo "======== ${{ github.ref }} - ${{env.GITHUB_REF_NAME}} - ${GITHUB_REF##*/} ======="
#          version=$(git describe --tags --dirty --always | sed -e 's/^v//')
#          echo "Build release $version"
#      - uses: valadas/get-release-branch-version@v1
#        id: branchVersion
#      - name: Dump the version info
#        env:
#          MAJOR: ${{ steps.branchVersion.outputs.major }}
#          MINOR: ${{ steps.branchVersion.outputs.minor }}
#          PATCH: ${{ steps.branchVersion.outputs.patch }}
#          MANIFEST_SAFE_VERSION_STRING: ${{ steps.branchVersion.outputs.manifestSafeVersionString }}
#        run: "echo major: $MAJOR minor: $MINOR patch: $PATCH manifestSafeVersionString: $MANIFEST_SAFE_VERSION_STRING"